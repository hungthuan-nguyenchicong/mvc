# h5
Có vẻ như bạn đang thiết lập một bộ định tuyến phía máy khách cơ bản trong JavaScript!

Hiện tại, Routerlớp của bạn sẽ ghi lại các lần nhấp vào <a>thẻ có data-linkthuộc tính rồi ghi hrefvào bảng điều khiển bằng tthàm.

Để biến đây thành một bộ định tuyến chức năng, bạn sẽ muốn mở rộng ttchức năng và trình lắng nghe sự kiện. Sau đây là những gì bạn có thể làm để cải thiện nó:

Các lĩnh vực chính cần cải thiện
ttchức năng (Logic điều hướng): Thay vì chỉ ghi nhật ký, chức năng này sẽ:
Cập nhật URL: Sử dụng history.pushState()để thay đổi URL của trình duyệt mà không cần tải lại toàn bộ trang.
Render Content: Dựa trên URL mới, xác định nội dung hoặc thành phần nào sẽ hiển thị trên trang. Đây là nơi logic định tuyến của bạn (ví dụ: ánh xạ đường dẫn đến chế độ xem) sẽ phát huy tác dụng.
Sự kiện Popstate: Bỏ chú thích và triển khai popstatetrình lắng nghe sự kiện. Sự kiện này kích hoạt khi người dùng điều hướng trở lại hoặc tiến lên qua lịch sử trình duyệt của họ (ví dụ: sử dụng các nút quay lại/tiến lên). Bộ định tuyến của bạn cần phản hồi những thay đổi này bằng cách hiển thị nội dung chính xác cho URL mới.
Cơ chế định tuyến: Bạn sẽ cần một cách để xác định các tuyến đường của mình. Đây có thể là một đối tượng đơn giản ánh xạ đường dẫn đến các chức năng hoặc thành phần hoặc một hệ thống phức tạp hơn.
Ví dụ về một bộ định tuyến hoàn thiện hơn
Đây là một ví dụ về cách bạn có thể mở rộng Routerđể xử lý điều hướng và hiển thị nội dung cơ bản. Đây là một ví dụ đơn giản nhưng nó minh họa các khái niệm cốt lõi.

JavaScript

// src/core/Router.js

function renderContent(path) {
    const appDiv = document.getElementById('app'); // Assume you have a div with id="app" to render content into
    if (!appDiv) {
        console.error("No element with id 'app' found to render content.");
        return;
    }

    switch (path) {
        case '/':
            appDiv.innerHTML = '<h1>Welcome to the Home Page!</h1><p>This is the main page content.</p>';
            break;
        case '/about':
            appDiv.innerHTML = '<h1>About Us</h1><p>Learn more about our company.</p>';
            break;
        case '/contact':
            appDiv.innerHTML = '<h1>Contact Us</h1><p>Get in touch with us.</p>';
            break;
        default:
            appDiv.innerHTML = '<h1>404 - Page Not Found</h1><p>The page you are looking for does not exist.</p>';
            break;
    }
}

export class Router {
    constructor() {
        this.init();
    }

    init() {
        // Listen for browser back/forward button events
        window.addEventListener('popstate', () => {
            renderContent(window.location.pathname);
        });

        // Listen for clicks on data-link attributes
        document.body.addEventListener('click', (e) => {
            const routeLink = e.target.closest('a[data-link]'); // Use e.target for more precise targeting
            if (routeLink) {
                e.preventDefault(); // Prevent default link behavior
                const path = routeLink.getAttribute('href');

                // Update URL and render content
                history.pushState(null, '', path);
                renderContent(path);
            }
        });

        // Initial content load based on current URL
        renderContent(window.location.pathname);
    }
}
Để ví dụ này hoạt động, bạn cũng cần:
Một tệp HTML có phần tử nơi nội dung của bạn sẽ được hiển thị, thường divcó ID như sau app:

HTML

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Single Page App</title>
</head>
<body>
    <nav>
        <a href="/" data-link>Home</a>
        <a href="/about" data-link>About</a>
        <a href="/contact" data-link>Contact</a>
    </nav>
    <div id="app">
        </div>
    <script type="module" src="./main.js"></script>
</body>
</html>
Tệp main.js(hoặc điểm vào tương tự) để khởi tạo bộ định tuyến của bạn:

JavaScript

// src/main.js
import { Router } from './core/Router.js';

document.addEventListener('DOMContentLoaded', () => {
    new Router();
});
Thiết lập này cung cấp cho bạn nền tảng cơ bản cho bộ định tuyến ứng dụng một trang (SPA). Khi bạn mở rộng, bạn có thể cân nhắc các tính năng nâng cao hơn như tuyến lồng nhau, tham số tuyến và tải lười các thành phần.