// src/Router.js

export class Router {
    constructor(targetElementId, routes) {
        this.targetElement = document.getElementById(targetElementId);
        this.routes = routes; // Một mảng các đối tượng route: [{ path: '/', view: () => '<h1>Home</h1>' }]
        this.init();
    }

    init() {
        // Lắng nghe sự kiện 'popstate' (khi người dùng dùng nút back/forward của trình duyệt)
        window.addEventListener('popstate', () => this.route());

        // Lắng nghe sự kiện 'routeChange' từ Sidebar hoặc các component khác
        window.addEventListener('routeChange', (e) => {
            this.route(e.detail); // Truyền path mới từ event detail
        });

        // Route ban đầu khi tải trang
        this.route();
    }

    async route(path = window.location.pathname) {
        let currentRoute = this.routes.find(route => route.path === path);

        if (!currentRoute) {
            // Xử lý route 404 Not Found
            currentRoute = {
                path: '/404',
                view: () => `
                    <h1>404 - Không tìm thấy trang</h1>
                    <p>Trang bạn đang tìm không tồn tại.</p>
                `
            };
        }

        // Lấy nội dung hoặc component cho route
        const content = await currentRoute.view();

        // Cập nhật nội dung vào phần tử target
        if (this.targetElement) {
            this.targetElement.innerHTML = content;
        } else {
            console.error(`Target element with ID '${this.targetElement.id}' not found.`);
        }
    }
}