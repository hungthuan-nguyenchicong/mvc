# h1

// js/route.js

/**
 * Abstract base class for all views in the SPA.
 * Defines the basic structure that every view should adhere to.
 */
class AbstractView {
    constructor(params) {
        this.params = params; // Parameters passed to the view (e.g., from URL path)
    }

    /**
     * Sets the title of the document.
     * @param {string} title The title to set for the document.
     */
    setTitle(title) {
        document.title = title;
    }

    /**
     * Returns the HTML content for the view.
     * This method must be implemented by concrete view classes.
     * @returns {string} The HTML string representing the view's content.
     */
    async getHtml() {
        return ""; // Default empty HTML
    }
}

/**
 * Represents the Dashboard view.
 * Displays a welcome message for the admin dashboard.
 */
class Dashboard extends AbstractView {
    constructor(params) {
        super(params);
    }

    async getHtml() {
        this.setTitle("Admin Dashboard");
        return `
            <section class="p-6 bg-white rounded-lg shadow-md max-w-4xl mx-auto">
                <h2 class="text-3xl font-bold mb-4 text-gray-800">Welcome to Your Dashboard!</h2>
                <p class="text-gray-700 text-lg">
                    This is your central hub for managing the application. Use the navigation above
                    to access different sections like Users and Products.
                </p>
                <div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-md text-blue-800">
                    <p class="font-semibold">Quick Stats:</p>
                    <ul class="list-disc list-inside mt-2">
                        <li>Total Users: 1,234</li>
                        <li>Active Products: 567</li>
                        <li>Pending Orders: 12</li>
                    </ul>
                </div>
            </section>
        `;
    }
}

/**
 * Represents the Users view.
 * Displays a list of example users.
 */
class Users extends AbstractView {
    constructor(params) {
        super(params);
    }

    async getHtml() {
        this.setTitle("Users Management");
        return `
            <section class="p-6 bg-white rounded-lg shadow-md max-w-4xl mx-auto">
                <h2 class="text-3xl font-bold mb-4 text-gray-800">Users Management</h2>
                <p class="text-gray-700 text-lg mb-6">
                    Here you can view, add, edit, or delete user accounts.
                </p>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider">ID</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider">Name</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider">Email</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider">Role</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            <tr>
                                <td class="py-3 px-4 text-gray-800">1</td>
                                <td class="py-3 px-4 text-gray-800">John Doe</td>
                                <td class="py-3 px-4 text-gray-800">john.doe@example.com</td>
                                <td class="py-3 px-4 text-gray-800">Admin</td>
                                <td class="py-3 px-4">
                                    <button class="text-blue-600 hover:text-blue-800 mr-2">Edit</button>
                                    <button class="text-red-600 hover:text-red-800">Delete</button>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-gray-800">2</td>
                                <td class="py-3 px-4 text-gray-800">Jane Smith</td>
                                <td class="py-3 px-4 text-gray-800">jane.smith@example.com</td>
                                <td class="py-3 px-4 text-gray-800">Editor</td>
                                <td class="py-3 px-4">
                                    <button class="text-blue-600 hover:text-blue-800 mr-2">Edit</button>
                                    <button class="text-red-600 hover:text-red-800">Delete</button>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-gray-800">3</td>
                                <td class="py-3 px-4 text-gray-800">Peter Jones</td>
                                <td class="py-3 px-4 text-gray-800">peter.j@example.com</td>
                                <td class="py-3 px-4 text-gray-800">Viewer</td>
                                <td class="py-3 px-4">
                                    <button class="text-blue-600 hover:text-blue-800 mr-2">Edit</button>
                                    <button class="text-red-600 hover:text-red-800">Delete</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        `;
    }
}

/**
 * Represents the Products view.
 * Displays a list of example products.
 */
class Products extends AbstractView {
    constructor(params) {
        super(params);
    }

    async getHtml() {
        this.setTitle("Products Catalog");
        return `
            <section class="p-6 bg-white rounded-lg shadow-md max-w-4xl mx-auto">
                <h2 class="text-3xl font-bold mb-4 text-gray-800">Products Catalog</h2>
                <p class="text-gray-700 text-lg mb-6">
                    Manage your product inventory here.
                </p>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider">ID</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider">Name</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider">Price</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider">Stock</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            <tr>
                                <td class="py-3 px-4 text-gray-800">101</td>
                                <td class="py-3 px-4 text-gray-800">Laptop Pro X</td>
                                <td class="py-3 px-4 text-gray-800">$1200.00</td>
                                <td class="py-3 px-4 text-gray-800">50</td>
                                <td class="py-3 px-4">
                                    <button class="text-blue-600 hover:text-blue-800 mr-2">Edit</button>
                                    <button class="text-red-600 hover:text-red-800">Delete</button>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-gray-800">102</td>
                                <td class="py-3 px-4 text-gray-800">Wireless Mouse</td>
                                <td class="py-3 px-4 text-gray-800">$25.99</td>
                                <td class="py-3 px-4 text-gray-800">200</td>
                                <td class="py-3 px-4">
                                    <button class="text-blue-600 hover:text-blue-800 mr-2">Edit</button>
                                    <button class="text-red-600 hover:text-red-800">Delete</button>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-gray-800">103</td>
                                <td class="py-3 px-4 text-gray-800">USB-C Hub</td>
                                <td class="py-3 px-4 text-gray-800">$49.99</td>
                                <td class="py-3 px-4 text-gray-800">120</td>
                                <td class="py-3 px-4">
                                    <button class="text-blue-600 hover:text-blue-800 mr-2">Edit</button>
                                    <button class="text-red-600 hover:text-red-800">Delete</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        `;
    }
}

/**
 * The Router class manages the application's routes and handles navigation.
 */
export class Router {
    constructor() {
        /**
         * Defines the application's routes.
         * Each object maps a path to a corresponding view class.
         * The 'view' property should be a constructor (class).
         */
        this.routes = [
            { path: "/", view: Dashboard },
            { path: "/users", view: Users },
            { path: "/products", view: Products },
        ];

        // Bind 'this' to the router method so it can be used as an event listener callback
        this.router = this.router.bind(this);

        // Add event listeners for navigation
        this.addEventListeners();
    }

    /**
     * Navigates to a new URL without reloading the page.
     * Updates the browser's history and triggers the router.
     * @param {string} url The URL to navigate to.
     */
    navigateTo(url) {
        history.pushState(null, null, url);
        this.router();
    }

    /**
     * The main router function.
     * Matches the current URL path to a defined route and renders the corresponding view.
     */
    async router() {
        // Test each route for a potential match
        const potentialMatches = this.routes.map(route => {
            return {
                route: route,
                isMatch: location.pathname === route.path
            };
        });

        let match = potentialMatches.find(potentialMatch => potentialMatch.isMatch);

        // If no match is found, redirect to the dashboard (or a 404 page)
        if (!match) {
            match = {
                route: this.routes[0], // Default to the dashboard route
                isMatch: true
            };
        }

        // Instantiate the view and render its content
        const view = new match.route.view();
        document.querySelector("#content").innerHTML = await view.getHtml();

        // Update active navigation link
        this.updateActiveNavLink();
    }

    /**
     * Updates the active class on navigation links based on the current path.
     */
    updateActiveNavLink() {
        const navLinks = document.querySelectorAll('header nav a');
        navLinks.forEach(link => {
            if (link.href === location.href) {
                link.classList.add('active');
            } else {
                link.classList.remove('active');
            }
        });
    }

    /**
     * Adds event listeners for browser history changes and navigation clicks.
     */
    addEventListeners() {
        // Listen for browser history changes (back/forward buttons)
        window.addEventListener("popstate", this.router);

        // Listen for clicks on navigation links
        document.addEventListener("DOMContentLoaded", () => {
            // Add Tailwind CSS for basic styling
            const tailwindScript = document.createElement('script');
            tailwindScript.src = 'https://cdn.tailwindcss.com';
            document.head.appendChild(tailwindScript);

            // Set Inter font family
            const interFontLink = document.createElement('link');
            interFontLink.href = 'https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap';
            interFontLink.rel = 'stylesheet';
            document.head.appendChild(interFontLink);

            const style = document.createElement('style');
            style.textContent = `
                body {
                    font-family: 'Inter', sans-serif;
                    background-color: #f3f4f6; /* Light gray background */
                }
                #app {
                    min-height: 100vh;
                    display: flex;
                    flex-direction: column;
                    justify-content: flex-start;
                    align-items: center;
                }
                header {
                    width: 100%;
                    background-color: #3b82f6; /* Blue-500 */
                    padding: 1rem 0;
                    text-align: center;
                    color: white;
                    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                    margin-bottom: 2rem;
                    border-radius: 0 0 10px 10px; /* Rounded bottom corners */
                }
                header h1 {
                    font-size: 2.5rem;
                    font-weight: 700;
                    margin-bottom: 1rem;
                }
                header nav a {
                    color: white;
                    margin: 0 1rem;
                    text-decoration: none;
                    font-weight: 500;
                    padding: 0.5rem 1rem;
                    border-radius: 0.5rem;
                    transition: background-color 0.3s ease;
                }
                header nav a:hover,
                header nav a.active {
                    background-color: rgba(255, 255, 255, 0.2);
                }
                main {
                    width: 100%;
                    max-width: 1200px;
                    padding: 0 1rem;
                }
                /* Styling for content sections inside main */
                section {
                    margin-bottom: 2rem;
                }
            `;
            document.head.appendChild(style);


            document.body.addEventListener("click", e => {
                // Check if the clicked element has the 'data-link' attribute
                if (e.target.matches("[data-link]")) {
                    e.preventDefault(); // Prevent default full page reload
                    this.navigateTo(e.target.href); // Call navigateTo from the Router instance
                }
            });

            // Initial router call when the DOM is fully loaded
            this.router();
        });
    }
}
